# 사용자 프로필 페이지

## 개요

사용자 프로필 페이지(`/profile/:username`)는 특정 사용자의 프로필 정보와 활동 내역을 표시하는 페이지입니다.

## 기능

### 프로필 정보 표시
- 사용자 아바타, 이름, 레벨 배지
- 자기소개(bio)
- 외부 링크 (웹사이트, GitHub, Twitter)
- 가입일

### 탭별 콘텐츠

#### 1. 포스트 탭
- 해당 사용자가 작성한 모든 포스트를 표시
- 일반 포스트, 프로젝트 업데이트, 마일스톤, 기능 수락, 프로젝트 생성, 공지, 피드백 등 모든 타입 포함
- 무한 스크롤 지원 (50개씩 로드)
- `/bookmarks`와 동일한 UI 구조

#### 2. 프로젝트 탭
- 해당 사용자가 생성한 프로젝트 목록 표시
- `/bookmark/project`와 동일한 UI 구조
- 무한 스크롤 지원 (50개씩 로드)

#### 3. 좋아요 탭
- 해당 사용자가 좋아요를 누른 포스트 목록 표시
- `tbl_post_likes` 테이블 기반 조회
- `/bookmarks`와 동일한 UI 구조
- 무한 스크롤 지원 (50개씩 로드)

#### 4. 배지 탭
- 해당 사용자가 획득한 배지 목록 표시

## API 함수

### 사용자 프로필 조회
```typescript
fetchUserProfile(username: string): Promise<FetchUserProfileResult>
```
- 위치: `src/entities/user/api/user.api.ts`
- SQL 함수: `odd.v1_fetch_user_profile`
- SQL 파일: `docs/sql/044_v1_fetch_user_profile.sql`

### 사용자 포스트 피드 조회
```typescript
fetchUserPostsFeed(username: string, options?: FetchUnifiedFeedOptions): Promise<{ data: UnifiedFeedPost[] | null; error: Error | null }>
```
- 위치: `src/entities/post/api/post.api.ts`
- SQL 함수: `odd.v1_fetch_user_posts_feed`
- SQL 파일: `docs/sql/045_v1_fetch_user_posts_feed.sql`

### 사용자 프로젝트 조회
```typescript
fetchUserProjects(username: string, options?: FetchUserProjectsOptions): Promise<FetchUserProjectsResult>
```
- 위치: `src/entities/project/api/project.api.ts`
- SQL 함수: `odd.v1_fetch_user_projects`
- SQL 파일: `docs/sql/046_v1_fetch_user_projects.sql`

### 사용자 좋아요 포스트 피드 조회
```typescript
fetchUserLikedPostsFeed(username: string, options?: FetchUnifiedFeedOptions): Promise<{ data: UnifiedFeedPost[] | null; error: Error | null }>
```
- 위치: `src/entities/post/api/post.api.ts`
- SQL 함수: `odd.v1_fetch_user_liked_posts_feed`
- SQL 파일: `docs/sql/047_v1_fetch_user_liked_posts_feed.sql`

## SQL 함수

### v1_fetch_user_profile
사용자 프로필 정보를 조회합니다.
- 매개변수: `p_username text`
- 반환값: 사용자 프로필 정보 (id, username, display_name, avatar_url, bio, website, github, twitter, points, level, subscribed_projects_count, supported_projects_count, projects_count, created_at)

### v1_fetch_user_posts_feed
특정 사용자가 작성한 포스트의 피드를 조회합니다.
- 매개변수: `p_username text`, `p_limit integer DEFAULT 50`, `p_offset integer DEFAULT 0`
- 반환값: 통합 피드 포스트 목록 (일반 포스트, 공지, 피드백 포함)

### v1_fetch_user_projects
특정 사용자가 생성한 프로젝트 목록을 조회합니다.
- 매개변수: `p_username text`, `p_limit integer DEFAULT 50`, `p_offset integer DEFAULT 0`
- 반환값: 프로젝트 목록 (작성자 정보, 실제 댓글 개수 포함)

### v1_fetch_user_liked_posts_feed
특정 사용자가 좋아요를 누른 포스트의 피드를 조회합니다.
- 매개변수: `p_username text`, `p_limit integer DEFAULT 50`, `p_offset integer DEFAULT 0`
- 반환값: 통합 피드 포스트 목록 (`tbl_post_likes` 테이블 기반)

## 구현 세부사항

### 페이지네이션
- 각 탭별로 독립적인 페이지네이션 상태 관리
- IntersectionObserver를 사용한 무한 스크롤
- 한 번에 50개씩 로드

### 인터랙션 처리
- 좋아요/북마크는 낙관적 업데이트 적용
- 에러 발생 시 롤백 처리
- 비회원 클릭 시 회원가입 모달 표시

### 프로필 편집
- 자신의 프로필인 경우 편집 버튼 표시
- 프로필 편집 모달을 통해 정보 수정 가능

## 관련 파일

- `src/pages/profile/ProfilePage.tsx` - 메인 컴포넌트
- `src/entities/user/api/user.api.ts` - 사용자 API 함수
- `src/entities/post/api/post.api.ts` - 포스트 API 함수
- `src/entities/project/api/project.api.ts` - 프로젝트 API 함수
- `docs/sql/044_v1_fetch_user_profile.sql` - 프로필 조회 SQL
- `docs/sql/045_v1_fetch_user_posts_feed.sql` - 포스트 피드 조회 SQL
- `docs/sql/046_v1_fetch_user_projects.sql` - 프로젝트 조회 SQL
- `docs/sql/047_v1_fetch_user_liked_posts_feed.sql` - 좋아요 포스트 피드 조회 SQL

